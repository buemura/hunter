/* ===== Reset & Base ===== */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;-webkit-text-size-adjust:100%}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  line-height:1.6;color:#1e293b;background:#f1f5f9;min-height:100vh;
  display:flex;flex-direction:column;
}

a{color:#2563eb;text-decoration:none}
a:hover{text-decoration:underline}

/* ===== Navbar ===== */
.navbar{
  background:#0f172a;color:#f8fafc;
  padding:0 1.5rem;height:56px;
  position:sticky;top:0;z-index:100;
  box-shadow:0 1px 3px rgba(0,0,0,.3);
}
.nav-container{
  max-width:1120px;margin:0 auto;height:100%;
  display:flex;align-items:center;justify-content:space-between;
}
.nav-brand{
  display:flex;align-items:center;gap:.5rem;
  font-size:1.15rem;font-weight:700;color:#f8fafc;
  text-decoration:none;letter-spacing:.02em;
}
.nav-brand:hover{text-decoration:none;color:#38bdf8}
.nav-icon{width:22px;height:22px;color:#38bdf8}
.nav-links{display:flex;gap:.25rem}
.nav-link{
  color:#cbd5e1;padding:.4rem .75rem;border-radius:6px;
  font-size:.875rem;font-weight:500;transition:background .15s,color .15s;
}
.nav-link:hover{background:#1e293b;color:#f8fafc;text-decoration:none}

/* ===== Layout ===== */
.container{max-width:1120px;margin:0 auto;padding:2rem 1.5rem;flex:1}
.footer{
  text-align:center;padding:1.25rem;color:#64748b;
  font-size:.8rem;border-top:1px solid #e2e8f0;margin-top:auto;
}

/* ===== Page Header ===== */
.page-header{
  display:flex;align-items:flex-start;justify-content:space-between;
  margin-bottom:1.5rem;gap:1rem;flex-wrap:wrap;
}
.page-header h1{font-size:1.5rem;font-weight:700;color:#0f172a}
.subtitle{color:#64748b;font-size:.875rem;margin-top:.15rem}
.mono{font-family:"SF Mono",SFMono-Regular,ui-monospace,Menlo,monospace;font-size:.8rem}

/* ===== Card ===== */
.card{
  background:#fff;border:1px solid #e2e8f0;border-radius:10px;
  padding:1.5rem;margin-bottom:1.25rem;
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}

/* ===== Buttons ===== */
.btn{
  display:inline-flex;align-items:center;gap:.4rem;
  padding:.5rem 1rem;border-radius:7px;font-size:.875rem;
  font-weight:600;border:none;cursor:pointer;
  text-decoration:none;transition:background .15s,box-shadow .15s;
  line-height:1.4;
}
.btn:hover{text-decoration:none}
.btn-primary{background:#2563eb;color:#fff}
.btn-primary:hover{background:#1d4ed8;box-shadow:0 2px 6px rgba(37,99,235,.3)}
.btn-primary:disabled{background:#93c5fd;cursor:not-allowed}
.btn-secondary{background:#f1f5f9;color:#334155;border:1px solid #cbd5e1}
.btn-secondary:hover{background:#e2e8f0}
.btn-danger{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}
.btn-danger:hover{background:#fee2e2}

/* ===== Forms ===== */
.form-group{margin-bottom:1.25rem}
.form-label{display:block;font-weight:600;font-size:.875rem;margin-bottom:.35rem;color:#334155}
.required{color:#dc2626}
.form-input{
  width:100%;padding:.55rem .75rem;border:1px solid #cbd5e1;
  border-radius:7px;font-size:.9rem;color:#1e293b;
  background:#fff;transition:border-color .15s,box-shadow .15s;
}
.form-input:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.15)}
.form-hint{display:block;font-size:.78rem;color:#94a3b8;margin-top:.25rem}
.form-row{display:flex;gap:1rem}
.form-half{flex:1;min-width:0}
.form-actions{margin-top:.5rem}

/* Checkboxes */
.select-all-label{font-weight:600;margin-bottom:.5rem}
.checkbox-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:.5rem;
}
.checkbox-label{
  display:flex;align-items:flex-start;gap:.4rem;
  padding:.45rem .6rem;border-radius:6px;cursor:pointer;
  font-size:.85rem;transition:background .1s;
}
.checkbox-label:hover{background:#f1f5f9}
.checkbox-label input[type="checkbox"]{margin-top:3px;accent-color:#2563eb}
.scanner-name{font-weight:600;color:#334155}
.scanner-desc{display:block;color:#64748b;font-size:.78rem;margin-top:1px}

/* ===== Alerts ===== */
.alert{padding:.75rem 1rem;border-radius:7px;font-size:.875rem;margin-bottom:1rem}
.alert-error{background:#fef2f2;color:#991b1b;border:1px solid #fecaca}

/* ===== Data Table ===== */
.data-table{width:100%;border-collapse:collapse;font-size:.875rem}
.data-table th{
  text-align:left;padding:.6rem .75rem;
  font-weight:600;color:#475569;font-size:.78rem;
  text-transform:uppercase;letter-spacing:.04em;
  border-bottom:2px solid #e2e8f0;background:#f8fafc;
}
.data-table td{padding:.6rem .75rem;border-bottom:1px solid #f1f5f9;vertical-align:top}
.data-table tbody tr:hover{background:#f8fafc}
.data-table .col-severity{width:110px}
.cell-target{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.cell-scanners{display:flex;flex-wrap:wrap;gap:.25rem}
.cell-time{white-space:nowrap;color:#64748b}
.cell-title{font-weight:500}
.link-mono{font-family:"SF Mono",SFMono-Regular,ui-monospace,Menlo,monospace;font-size:.82rem}

/* ===== Pills & Badges ===== */
.pill{
  display:inline-block;padding:2px 8px;border-radius:999px;
  font-size:.72rem;font-weight:600;
  background:#e2e8f0;color:#475569;white-space:nowrap;
}

/* Status badges */
.status-badge{
  display:inline-block;padding:2px 10px;border-radius:999px;
  font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.03em;
}
.status-pending{background:#f1f5f9;color:#64748b}
.status-running{background:#fef3c7;color:#92400e;animation:pulse 2s infinite}
.status-completed{background:#dcfce7;color:#166534}
.status-failed{background:#fef2f2;color:#991b1b}

@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}

/* Severity pills */
.sev-pill{
  display:inline-block;padding:2px 10px;border-radius:999px;
  font-size:.72rem;font-weight:700;color:#fff;text-transform:uppercase;
  letter-spacing:.03em;white-space:nowrap;
}
.sev-critical{background:#dc2626}
.sev-high{background:#ea580c}
.sev-medium{background:#ca8a04;color:#422006}
.sev-low{background:#0891b2}
.sev-info{background:#6b7280}

/* ===== Severity Summary ===== */
.severity-summary h2{margin-bottom:.75rem}
.severity-pills{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center}
.total-count{font-weight:700;color:#334155;margin-left:.25rem}

/* ===== Meta Grid ===== */
.meta-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
  gap:.75rem;margin-bottom:1.25rem;
}
.meta-item{
  background:#fff;border:1px solid #e2e8f0;border-radius:8px;
  padding:.75rem 1rem;
}
.meta-label{display:block;font-size:.72rem;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:.05em;margin-bottom:.2rem}
.meta-value{font-size:.9rem;color:#1e293b;word-break:break-all}

/* ===== Progress ===== */
.progress-track{
  height:10px;background:#e2e8f0;border-radius:999px;
  overflow:hidden;margin:.75rem 0 .5rem;
}
.progress-fill{
  height:100%;background:linear-gradient(90deg,#2563eb,#38bdf8);
  border-radius:999px;transition:width .4s ease;
}
.progress-text{font-size:.85rem;color:#64748b}

/* ===== Action Bar ===== */
.action-bar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1.25rem}

/* ===== Results Card ===== */
.results-card{overflow-x:auto}
.results-header{
  display:flex;align-items:center;gap:.75rem;
  margin-bottom:.75rem;
}
.results-header h3{font-size:1.05rem;color:#0f172a}
.text-muted{color:#94a3b8;font-style:italic;font-size:.875rem}

/* Finding details */
.finding-details{margin-top:.5rem}
.finding-details summary{
  cursor:pointer;color:#2563eb;font-size:.8rem;font-weight:500;
}
.finding-details summary:hover{text-decoration:underline}
.detail-block{margin-top:.4rem}
.detail-block pre{
  background:#f8fafc;border:1px solid #e2e8f0;border-radius:6px;
  padding:.5rem .75rem;font-size:.8rem;overflow-x:auto;
  margin-top:.25rem;white-space:pre-wrap;word-break:break-all;
}
.detail-block p{margin-top:.25rem;font-size:.85rem;color:#475569}

/* ===== Empty State ===== */
.empty-state{text-align:center;padding:3rem 1rem;color:#64748b}

/* ===== Responsive ===== */
@media(max-width:640px){
  .container{padding:1rem}
  .page-header{flex-direction:column}
  .form-row{flex-direction:column;gap:0}
  .meta-grid{grid-template-columns:1fr 1fr}
  .checkbox-grid{grid-template-columns:1fr}
  .data-table{font-size:.8rem}
  .data-table th,.data-table td{padding:.4rem .5rem}
}
